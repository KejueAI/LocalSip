# =============================================================================
# Scalable Cloud Deployment Configuration (AWS ECS / Kubernetes)
# =============================================================================
# This file documents the environment variables needed for Terraform/ECS/K8s.
# In production, these are injected via:
#   - AWS: ECS task definition env vars + Secrets Manager
#   - K8s: ConfigMaps + Secrets
#
# This file is NOT used directly with docker compose.
# It serves as a reference for what Terraform/Helm needs to configure.
# =============================================================================

# --- External SIP/RTP IP ---
# Injected from Terraform output: NAT instance EIP
# e.g. aws_eip.nat_instance.public_ip
FS_EXTERNAL_SIP_IP=<NAT_INSTANCE_EIP>
FS_EXTERNAL_RTP_IP=<NAT_INSTANCE_EIP>

# --- Database ---
# From Terraform: RDS Aurora cluster endpoint
# Stored in AWS Secrets Manager, referenced by ECS task definition
POSTGRES_USER=somleng
POSTGRES_PASSWORD=<FROM_SECRETS_MANAGER>
DATABASE_HOST=<RDS_CLUSTER_ENDPOINT>

# --- Redis ---
# From Terraform: ElastiCache endpoint
REDIS_URL=redis://<ELASTICACHE_ENDPOINT>:6379/0
REDIS_URL_SWITCH=redis://<ELASTICACHE_ENDPOINT>:6379/1

# --- Somleng API ---
RAILS_ENV=production
SOMLENG_API_HOST=<INTERNAL_ALB_DNS>
SOMLENG_API_PORT=3000
DASHBOARD_URL_HOST=https://dashboard.somleng.org
DB_POOL=30

# --- Switch / FreeSWITCH ---
# In ECS, services discover each other via service discovery (Cloud Map)
# or internal ALB. These hostnames resolve within the VPC.
SWITCH_HOST=http://<SWITCH_SERVICE_DISCOVERY_NAME>:8080
FS_ESL_HOST=<FREESWITCH_SERVICE_DISCOVERY_NAME>
FS_ESL_PORT=8021
FS_ESL_PASSWORD=<FROM_SECRETS_MANAGER>
FS_DATABASE_HOST=<RDS_CLUSTER_ENDPOINT>
SIP_GATEWAY_DIR=/sip_gateways
SIP_PORT=5060

# --- Rating Engine ---
RATING_ENGINE_HOST=http://<RATING_ENGINE_SERVICE_DISCOVERY_NAME>:2080
RATING_ENGINE_USERNAME=cgrates
RATING_ENGINE_PASSWORD=<FROM_SECRETS_MANAGER>
STUB_RATING_ENGINE=false
STORDB_DBNAME=cgrates

# --- AnyCable ---
ANYCABLE_SECRET=<FROM_SECRETS_MANAGER>
ANYCABLE_BROADCAST_ADAPTER=redisx

# --- Container Images ---
# All images are built from source and pushed to ECR
# SOMLENG_IMAGE=<AWS_ACCOUNT_ID>.dkr.ecr.<REGION>.amazonaws.com/somleng:latest
# SWITCH_IMAGE=<AWS_ACCOUNT_ID>.dkr.ecr.<REGION>.amazonaws.com/switch:latest
